# 联通网盘可视化下载器

## 📋 程序简介

这是一个基于Python tkinter开发的联通网盘可视化下载器，提供友好的图形界面来浏览文件和获取下载链接。

## ✨ 主要功能

- 🔐 **Token管理**: 安全保存和管理联通网盘Token
- 📁 **文件浏览**: 可视化浏览网盘文件夹结构
- 🔍 **多级目录**: 支持深层目录结构浏览
- 📥 **下载链接**: 一键获取文件真实下载地址
- 📤 **文件上传**: 支持单个文件上传到当前文件夹
- 📁 **文件夹上传**: 支持整个文件夹上传，自动创建目录结构
- 📂 **文件夹管理**: 创建新文件夹
- 🗑️ **删除操作**: 删除文件和文件夹
- 📋 **链接管理**: 复制链接到剪贴板或浏览器打开
- 🖱️ **右键菜单**: 便捷的右键操作菜单
- 📊 **上传进度**: 实时显示上传进度
- 💾 **配置保存**: 自动保存Token配置

## 🚀 快速开始

### 方法1: 直接运行Python程序

```bash
# 1. 安装依赖
pip install -r requirements_gui.txt

# 2. 运行程序
python wopan_gui.py
```

### 方法2: 打包成exe文件

```bash
# 1. 运行打包脚本
python build_exe.py
# 或者
build.bat

# 2. 运行生成的exe
release/联通网盘下载器.exe
```

## 📁 文件结构

```
├── wopan_gui.py              # 主程序文件
├── requirements_gui.txt      # Python依赖
├── build_exe.py             # 打包脚本(Python)
├── build.bat                # 打包脚本(批处理)
├── test_gui.py              # 测试脚本
└── GUI程序说明.md           # 说明文档
```

## 🔧 使用方法

### 1. 获取Token

1. 打开联通网盘网页版 (https://pan.wo.cn)
2. 登录您的账号
3. 打开浏览器开发者工具 (F12)
4. 切换到"网络"标签
5. 刷新页面或进行任何操作
6. 在请求中找到包含`Accesstoken`的请求头
7. 复制Token值

### 2. 使用程序

1. **启动程序**: 运行`wopan_gui.py`或exe文件
2. **输入Token**: 在Token输入框中粘贴您的Token
3. **连接**: 点击"连接"按钮
4. **浏览文件**: 双击文件夹进入，双击文件获取下载链接
5. **下载文件**: 选择文件后点击"获取下载链接"按钮
6. **上传文件**: 点击"选择文件上传"按钮选择本地文件上传
7. **创建文件夹**: 点击"新建文件夹"按钮创建新目录
8. **删除文件**: 选择文件或文件夹后点击"删除"按钮
9. **使用链接**: 复制链接或在浏览器中打开

### 3. 界面说明

- **Token配置区**: 输入和保存Token
- **导航栏**: 显示当前路径，返回上级目录
- **文件列表**: 显示文件和文件夹，支持排序
- **下载操作区**: 获取下载链接、复制链接、浏览器打开
- **上传操作区**: 选择文件上传、新建文件夹
- **状态栏**: 显示当前操作状态

## 🎯 操作技巧

### 快捷操作
- **双击文件夹**: 进入文件夹
- **双击文件**: 获取下载链接
- **右键菜单**: 显示上下文菜单（包含上传、新建文件夹选项）
- **返回按钮**: 返回上级目录
- **刷新按钮**: 刷新当前文件夹
- **拖拽上传**: 将文件拖拽到程序窗口上传（计划功能）

### 键盘快捷键
- **Ctrl+C**: 复制选中的下载链接
- **F5**: 刷新当前文件夹
- **Backspace**: 返回上级目录

## 🔧 技术细节

### 核心技术
- **GUI框架**: Python tkinter
- **HTTP请求**: requests库
- **加密解密**: pycryptodome (AES加密)
- **打包工具**: PyInstaller

### API接口
- **文件列表**: QueryAllFiles接口
- **下载链接**: GetDownloadUrlV2接口
- **加密通信**: AES-CBC加密

### 安全特性
- Token本地加密存储
- HTTPS安全通信
- 请求签名验证

## 🐛 常见问题

### Q: 程序无法启动？
A: 检查Python版本(需要3.7+)和依赖安装

### Q: Token连接失败？
A: 检查Token是否正确，是否过期

### Q: 文件列表为空？
A: 检查网络连接，Token权限

### Q: 下载链接获取失败？
A: 文件可能被删除或Token权限不足

### Q: exe文件打包失败？
A: 检查PyInstaller安装，依赖是否完整

## 📦 打包说明

### 自动打包
```bash
# Windows
build.bat

# Python通用
python build_exe.py
```

### 手动打包
```bash
pyinstaller --onefile --windowed --name="联通网盘下载器" wopan_gui.py
```

### 打包选项说明
- `--onefile`: 打包成单个exe文件
- `--windowed`: 不显示控制台窗口
- `--name`: 指定exe文件名
- `--icon`: 指定图标文件

## 🔄 更新日志

### v1.1 (2025-08-27)
- ✅ 基础GUI界面
- ✅ Token管理功能
- ✅ 文件浏览功能
- ✅ 下载链接获取
- ✅ 多级目录支持
- ✅ 文件上传功能
- ✅ 新建文件夹功能
- ✅ 上传进度显示
- ✅ 右键菜单增强
- ✅ 配置保存

## 📞 技术支持

如遇问题，请检查：
1. Python版本是否为3.7+
2. 依赖库是否正确安装
3. Token是否有效
4. 网络连接是否正常
5. 防火墙是否阻止程序

## 📄 许可证

本程序仅供学习和个人使用，请遵守相关法律法规。
